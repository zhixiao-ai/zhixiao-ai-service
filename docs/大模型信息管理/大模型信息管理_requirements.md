# 大模型信息管理功能需求

## 1. 需求背景和概述

### 1.1 需求背景
随着大模型技术的快速发展,智小AI平台需要支持多种厂商、多种类型的大模型服务。不同租户和用户可能需要使用不同的大模型能力,因此需要建立一个统一的大模型信息管理系统,用于管理和维护平台支持的所有大模型信息。

### 1.2 需求概述
大模型信息管理功能提供对大模型基本信息的全生命周期管理,包括模型的增删改查、版本管理、权限控制、状态管理等核心能力。系统需要支持模型信息的多级归属(租户级、用户私有级),并支持存储模型调用所需的配置信息。

## 2. 影响用户、角色、重要程度

### 2.1 影响用户
- **平台管理员**: 负责维护平台级别的全局大模型信息
- **租户管理员**: 负责管理租户级别的大模型信息
- **普通用户**: 可以创建和管理自己的私有模型信息,使用已授权的模型

### 2.2 角色权限
- **平台管理员**: 可以查看和管理所有模型信息,包括租户级和用户私有模型
- **租户管理员**: 可以查看和管理本租户的模型信息,不能访问其他租户或用户私有模型
- **普通用户**: 只能查看和使用已授权的模型(租户级+用户私有级),可以管理自己的私有模型

### 2.3 重要程度
**高优先级** - 核心基础功能,影响整个平台的大模型服务能力

## 功能性描述

### 功能点1: 模型信息创建

#### 1.1 租户级模型创建
- 租户管理员可以创建租户级别的模型信息
- 租户级模型创建后,该租户下的所有用户都可以查看和使用该模型
- 需要记录模型归属的租户信息

#### 1.2 用户私有模型创建
- 普通用户可以创建自己的私有模型信息
- 私有模型仅创建者本人可以使用和查看
- 系统需记录模型归属的用户信息

#### 1.3 创建信息记录
- 记录模型的基本信息:模型名称、模型厂家、模型版本、模型描述
- 记录模型的归属信息:所属租户、所属用户(可选)
- 记录模型的配置信息:API Key、API Endpoint、其他调用参数
- 记录创建信息:创建用户、创建时间
- 记录模型状态:默认为启用状态

### 功能点2: 模型信息查询

#### 2.1 模型列表查询
- 支持分页查询模型列表
- 支持按条件筛选:按模型厂家、按模型名称、按状态、按归属类型(租户级/用户私有)
- 支持关键词搜索:模型名称、描述

#### 2.2 模型详情查询
- 查询单个模型的完整信息
- 包括基本信息、配置信息、归属信息、状态信息、创建信息、更新信息
- 租户用户只能查看本租户的模型信息
- 普通用户只能查看自己的私有模型和本租户的租户级模型

#### 2.3 我的模型查询
- 普通用户可以查看"我的模型"列表
- 包括:自己创建的私有模型 + 所属租户的租户级模型

### 功能点3: 模型信息修改

#### 3.1 基本信息修改
- 支持修改模型名称、模型描述
- 支持修改模型版本信息
- 支持修改模型配置信息(API Key、Endpoint 等)
- 记录最后修改用户和修改时间

#### 3.2 权限控制
- 只有模型创建者或具有管理权限的用户可以修改模型信息
- 租户管理员可以修改本租户的所有模型信息
- 平台管理员可以修改所有模型信息

#### 3.3 归属类型变更
- 支持将用户私有模型升级为租户级模型(需租户管理员权限)
- 支持将租户级模型降级为用户私有模型(需租户管理员权限)

### 功能点4: 模型信息删除

#### 4.1 软删除机制
- 采用软删除方式,不立即物理删除数据
- 删除后模型状态标记为已删除,不再显示在列表中

#### 4.2 删除权限控制
- 模型创建者可以删除自己创建的私有模型
- 租户管理员可以删除本租户的所有模型
- 平台管理员可以删除所有模型

#### 4.3 删除限制
- 如果模型正在被其他服务或任务使用,需要提示用户确认是否删除
- 支持批量删除操作

### 功能点5: 模型版本管理

#### 5.1 版本记录
- 支持记录模型的版本号,如 GPT-4、GPT-4-turbo、GPT-3.5-turbo 等
- 同一模型名称可以有多个版本记录
- 每个版本可以有不同的配置信息

#### 5.2 版本查询
- 支持按模型名称查询所有版本
- 支持按版本号精确查询

#### 5.3 版本状态管理
- 每个版本可以独立设置启用/禁用状态
- 某个版本禁用不影响其他版本的可用性

### 功能点6: 模型状态管理

#### 6.1 状态类型
- **启用状态**: 模型可以被正常调用和使用
- **禁用状态**: 模型暂停使用,但不删除数据
- **已删除状态**: 标记为删除,不再显示

#### 6.2 状态切换
- 支持在启用和禁用状态之间切换
- 记录状态变更的操作人和变更时间
- 状态切换需有相应权限

#### 6.3 状态影响
- 禁用状态的模型不对外提供服务
- 查询时默认不显示已删除状态的模型

### 功能点7: 模型厂家管理

#### 7.1 厂家信息记录
- 记录模型所属厂家:OpenAI、百度文心、阿里通义、讯飞星火等
- 厂家信息作为模型的必填字段

#### 7.2 厂家筛选
- 支持按厂家筛选模型列表
- 统计各厂家的模型数量

### 功能点8: 模型配置信息管理

#### 8.1 配置信息存储
- 存储 API Key:用于调用模型的认证密钥
- 存储 API Endpoint:模型的调用接口地址
- 存储其他调用参数:如 temperature、max_tokens 等默认参数
- 敏感信息(如 API Key)需要加密存储

#### 8.2 配置信息隔离
- 租户级模型的配置信息在租户级别共享
- 用户私有模型的配置信息仅该用户可用

#### 8.3 配置信息修改
- 支持单独修改模型的配置信息
- 配置修改后立即生效

### 功能点9: 操作日志

#### 9.1 操作记录
- 记录所有模型操作的日志:创建、修改、删除、状态变更
- 记录操作人、操作时间、操作类型、操作前后的数据变更

#### 9.2 日志查询
- 支持按模型查询操作历史
- 支持按操作人查询操作历史
- 支持按时间范围查询操作历史

## 非功能性描述

### 1. 运行环境

#### 1.1 操作系统
- 支持 Linux、Windows Server 等主流服务器操作系统

#### 1.2 数据库
- 关系型数据库:MySQL 8.0+ 或 PostgreSQL 12+
- 数据库字符集:UTF-8

#### 1.3 中间件
- Spring Boot 3.5+
- Java 25+
- 支持 Redis 作为缓存(可选)

#### 1.4 部署方式
- 支持容器化部署(Docker)
- 支持传统服务器部署

### 2. 性能要求

#### 2.1 响应时间
- 模型列表查询:分页查询响应时间 < 500ms
- 模型详情查询:响应时间 < 200ms
- 模型创建/修改/删除:响应时间 < 300ms

#### 2.2 并发能力
- 支持至少 100 QPS 的查询并发
- 支持至少 50 TPS 的写操作并发

#### 2.3 数据量
- 支持单租户下至少 10000 条模型记录
- 支持平台级至少 100000 条模型记录

### 3. 安全要求

#### 3.1 数据安全
- 敏感信息(API Key 等)必须加密存储
- 支持数据访问的权限控制
- 支持操作审计日志

#### 3.2 接口安全
- 需要身份认证和授权
- 支持 JWT 或类似的认证机制
- 接口需要防重放攻击

### 4. 可扩展性

#### 4.1 功能扩展
- 预留扩展接口,支持未来增加更多模型属性
- 预留扩展接口,支持自定义模型参数

#### 4.2 性能扩展
- 支持通过缓存提升查询性能
- 支持数据库读写分离

### 5. 可用性

#### 5.1 服务可用性
- 服务可用性 >= 99.9%

#### 5.2 数据一致性
- 模型信息的修改需要保证强一致性
- 配置信息的修改需要实时生效

## 附录:核心数据要素

### 模型信息核心字段
- 模型ID:全局唯一标识
- 模型名称:如 GPT-4、文心一言等
- 模型厂家:如 OpenAI、百度等
- 模型版本:如 turbo-2024-01-01
- 模型描述:模型功能说明
- 所属租户ID:租户级模型必填
- 所属用户ID:用户私有模型必填
- API Key:调用密钥(加密存储)
- API Endpoint:接口地址
- 其他配置参数:JSON 格式存储
- 状态:启用/禁用/已删除
- 创建用户ID:创建人
- 创建时间:创建时间戳
- 最后修改用户ID:最后修改人
- 最后修改时间:最后修改时间戳
